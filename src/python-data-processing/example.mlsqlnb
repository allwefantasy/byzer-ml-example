[{"kind":2,"language":"mlsql","value":"load delta.`demo.iris` as iris;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"sepal_length\",\n\t\t\t\t\"type\": \"double\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"sepal_width\",\n\t\t\t\t\"type\": \"double\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"petal_length\",\n\t\t\t\t\"type\": \"double\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"petal_width\",\n\t\t\t\t\"type\": \"double\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"species\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"species_id\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.9,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.7,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.6,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.6,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3.9,\n\t\t\t\"petal_length\": 1.7,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.6,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.4,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.9,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3.7,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.8,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.8,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.3,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.1,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.8,\n\t\t\t\"sepal_width\": 4,\n\t\t\t\"petal_length\": 1.2,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 4.4,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3.9,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 3.8,\n\t\t\t\"petal_length\": 1.7,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.8,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.7,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.7,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.6,\n\t\t\t\"sepal_width\": 3.6,\n\t\t\t\"petal_length\": 1,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.3,\n\t\t\t\"petal_length\": 1.7,\n\t\t\t\"petal_width\": 0.5,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.8,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.9,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.2,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.2,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.7,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.8,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.2,\n\t\t\t\"sepal_width\": 4.1,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 4.2,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.9,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 1.2,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.9,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.1,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.4,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.5,\n\t\t\t\"sepal_width\": 2.3,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.4,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 1.3,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.5,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.6,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.8,\n\t\t\t\"petal_length\": 1.9,\n\t\t\t\"petal_width\": 0.4,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.8,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.3,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 3.8,\n\t\t\t\"petal_length\": 1.6,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.6,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.3,\n\t\t\t\"sepal_width\": 3.7,\n\t\t\t\"petal_length\": 1.5,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 3.3,\n\t\t\t\"petal_length\": 1.4,\n\t\t\t\"petal_width\": 0.2,\n\t\t\t\"species\": \"setosa\",\n\t\t\t\"species_id\": 1\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 7,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 4.7,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.4,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.9,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 4.9,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 2.3,\n\t\t\t\"petal_length\": 4,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.5,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4.6,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.3,\n\t\t\t\"sepal_width\": 3.3,\n\t\t\t\"petal_length\": 4.7,\n\t\t\t\"petal_width\": 1.6,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 4.9,\n\t\t\t\"sepal_width\": 2.4,\n\t\t\t\"petal_length\": 3.3,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.6,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.6,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.2,\n\t\t\t\"sepal_width\": 2.7,\n\t\t\t\"petal_length\": 3.9,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 2,\n\t\t\t\"petal_length\": 3.5,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.9,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.2,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6,\n\t\t\t\"sepal_width\": 2.2,\n\t\t\t\"petal_length\": 4,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.1,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.7,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.6,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 3.6,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.7,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 4.4,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.6,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.8,\n\t\t\t\"sepal_width\": 2.7,\n\t\t\t\"petal_length\": 4.1,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.2,\n\t\t\t\"sepal_width\": 2.2,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.6,\n\t\t\t\"sepal_width\": 2.5,\n\t\t\t\"petal_length\": 3.9,\n\t\t\t\"petal_width\": 1.1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.9,\n\t\t\t\"sepal_width\": 3.2,\n\t\t\t\"petal_length\": 4.8,\n\t\t\t\"petal_width\": 1.8,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.1,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.3,\n\t\t\t\"sepal_width\": 2.5,\n\t\t\t\"petal_length\": 4.9,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.1,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4.7,\n\t\t\t\"petal_width\": 1.2,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.4,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.3,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.6,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.4,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.8,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4.8,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.7,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 5,\n\t\t\t\"petal_width\": 1.7,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 2.6,\n\t\t\t\"petal_length\": 3.5,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 2.4,\n\t\t\t\"petal_length\": 3.8,\n\t\t\t\"petal_width\": 1.1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 2.4,\n\t\t\t\"petal_length\": 3.7,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.8,\n\t\t\t\"sepal_width\": 2.7,\n\t\t\t\"petal_length\": 3.9,\n\t\t\t\"petal_width\": 1.2,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6,\n\t\t\t\"sepal_width\": 2.7,\n\t\t\t\"petal_length\": 5.1,\n\t\t\t\"petal_width\": 1.6,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.4,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6,\n\t\t\t\"sepal_width\": 3.4,\n\t\t\t\"petal_length\": 4.5,\n\t\t\t\"petal_width\": 1.6,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.7,\n\t\t\t\"sepal_width\": 3.1,\n\t\t\t\"petal_length\": 4.7,\n\t\t\t\"petal_width\": 1.5,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.3,\n\t\t\t\"sepal_width\": 2.3,\n\t\t\t\"petal_length\": 4.4,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.6,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.1,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 2.5,\n\t\t\t\"petal_length\": 4,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.5,\n\t\t\t\"sepal_width\": 2.6,\n\t\t\t\"petal_length\": 4.4,\n\t\t\t\"petal_width\": 1.2,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.1,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.6,\n\t\t\t\"petal_width\": 1.4,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.8,\n\t\t\t\"sepal_width\": 2.6,\n\t\t\t\"petal_length\": 4,\n\t\t\t\"petal_width\": 1.2,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5,\n\t\t\t\"sepal_width\": 2.3,\n\t\t\t\"petal_length\": 3.3,\n\t\t\t\"petal_width\": 1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.6,\n\t\t\t\"sepal_width\": 2.7,\n\t\t\t\"petal_length\": 4.2,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 3,\n\t\t\t\"petal_length\": 4.2,\n\t\t\t\"petal_width\": 1.2,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.2,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 6.2,\n\t\t\t\"sepal_width\": 2.9,\n\t\t\t\"petal_length\": 4.3,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.1,\n\t\t\t\"sepal_width\": 2.5,\n\t\t\t\"petal_length\": 3,\n\t\t\t\"petal_width\": 1.1,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t},\n\t\t{\n\t\t\t\"sepal_length\": 5.7,\n\t\t\t\"sepal_width\": 2.8,\n\t\t\t\"petal_length\": 4.1,\n\t\t\t\"petal_width\": 1.3,\n\t\t\t\"species\": \"versicolor\",\n\t\t\t\"species_id\": 2\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"!desc iris json;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"value\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"value\": \"{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"sepal_length\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"sepal_width\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"petal_length\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"petal_width\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"species\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"species_id\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]}\"\n\t\t}\n\t]\n}"}]},{"kind":1,"language":"markdown","value":"## 自动将SQL 表转化为pandas, 进而进行操作。这种适合数据已经被聚合，数据规模不大的场景。","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=iris\n#%dataMode=model\n#%schema=st(field(content,string),field(mime,string))\n#%pythonExec=/opt/miniconda3/envs/ray-2.3.0/bin/python\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nimport plotly.express as px\nfrom sklearn.decomposition import PCA\n\ncontext:PythonContext = context\nray_context = RayContext.connect(globals(),None)\ndf = ray_context.to_pandas()\n\nfeatures = [\"sepal_width\", \"sepal_length\", \"petal_width\", \"petal_length\"]\n\npca = PCA()\ncomponents = pca.fit_transform(df[features])\nlabels = {\n    str(i): f\"PC {i+1} ({var:.1f}%)\"\n    for i, var in enumerate(pca.explained_variance_ratio_ * 100)\n}\n\nfig = px.scatter_matrix(\n    components,\n    labels=labels,\n    dimensions=range(4),\n    color=df[\"species\"]\n)\nfig.update_traces(diagonal_visible=False)\ncontent = fig.to_html()\n\n\ncontext.build_result([{\"content\":content,\"mime\":\"html\"}])","outputs":[]},{"kind":1,"language":"markdown","value":"## 使用Python做分布式数据处理\n\n这个示例需要使用 Ray ,如果你没有远程 Ray 集群，可以本地在 `ray-1.12.0` 环境中一个单机的Ray 集群：\n\n```\nray start --head --port 6380\n```\n\n一些注释说明：\n需要配置下 python 输出的 schema，这里用json, 是避免手写，可以通过前面的 !desc 生成。\n\n```\n#%schema={\"type\":\"struct\",\"fields\":[{\"name\":\"sepal_length\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"sepal_width\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"petal_length\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"petal_width\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"species\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"species_id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}\n```\n\n\n因为是Notebook 环境，该Cell产生的数据会被反复使用，所以需要配置下缓存\n\n```\n#%cache=true\n```\n\n只要使用了 foreach,map_iter 两个函数中的某一个时，则需要设置 `dataMode` 为 `data`\n\n```\n#%dataMode=data\n```\n\n指定输出的表为 `iris_scale` 方便后续的SQL使用。\n\n```\n#%output=iris_scale\n```\n","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=iris\n#%output=iris_scale\n#%pythonExec=/opt/miniconda3/envs/ray-2.3.0/bin/python\n#%schema={\"type\":\"struct\",\"fields\":[{\"name\":\"sepal_length\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"sepal_width\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"petal_length\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"petal_width\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"species\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"species_id\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}}]}\n#%cache=true\n#%dataMode=data\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\n\ncontext:PythonContext = context\n\n\nray_context = RayContext.connect(globals(),\"127.0.0.1:10001\")\n\ndef row_process(row):\n    row[\"sepal_width\"] = row[\"sepal_width\"] + 1\n    return row\n\nray_context.foreach(row_process)","outputs":[]},{"kind":1,"language":"markdown","value":"## 现在，我们可以直接引用 Ray 集群处理的数据了","outputs":[]},{"kind":2,"language":"mlsql","value":"select sepal_width from iris_scale as output;","outputs":[]},{"kind":1,"language":"markdown","value":"## 使用分布式 Pandas（on Dask） 来做一些聚合处理","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=iris\n#%output=iris_scale1\n#%pythonExec=/opt/miniconda3/envs/ray-2.3.0/bin/python\n#%schema=st(field(species,string),field(mean,double))\n#%cache=true\n#%dataMode=model\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nimport pandas as pd\n\ncontext:PythonContext = context\n\nray_context = RayContext.connect(globals(),\"127.0.0.1:10001\")\ndf = ray_context.to_dataset().to_dask()\n\nprint(df.head(10))\n\ndf2 = df.groupby(\"species\").sepal_length.mean().compute()\ndf3 =  pd.DataFrame({\"species\":df2.index,\"mean\":df2.to_list()})\ncontext.set_output([[df3[name] for name in df3]])","outputs":[]},{"kind":1,"language":"markdown","value":"## 通过SQL 访问 Dask 处理后的结果","outputs":[]},{"kind":2,"language":"mlsql","value":"select * from iris_scale1 as output;","outputs":[]},{"kind":1,"language":"markdown","value":"## 自定义获取数据\n\n这里，我们介绍一些更底层的API，帮助大家理解如何在Python中进行一些分布式处理。\n\n这里有几个注意的点：\n\n通过 `ray_context.data_servers()` 可以获得 `iris`表的多个数据分片引用。这些引用可以通过 `RayContext.collect_from` 函数进行获取。注意，该函数\n需要获取传递 list 进去。\n\n通过 `@ray.remote` 进行标注对应的类会被远程执行， `@rayfix.last` 来修正特定的一个问题，该注解需要放在最后。\n\n远程方法的调用例子如下：\n\n```\nv = count.remote(data_ref)\n```\n\n不过此时 v 是一个数据引用，你需要通过 ray.get 阻塞获取该值：\n\n```\nray.get(v)\n```\n\n所以下面的示例代码：\n\n```\nvalues = [count.remote(data_ref) for data_ref in data_refs]\nfinal_c = sum([ray.get(v) for v in values])\n```\n\n是实际上分布式执行的。\n","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=iris\n#%pythonExec=/opt/miniconda3/envs/ray-2.3.0/bin/python\n#%schema=st(field(size,long))\n#%cache=false\n#%dataMode=model\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nfrom pyjava import rayfix\nimport ray\n\ncontext:PythonContext = context\n\nray_context = RayContext.connect(globals(),\"127.0.0.1:10001\")\ndata_refs = ray_context.data_servers()\n\n@ray.remote\n@rayfix.last\ndef count(data_ref):\n    c = 0\n    for item in RayContext.collect_from([data_ref]):\n        c = c + 1\n    return c    \n\nvalues = [count.remote(data_ref) for data_ref in data_refs]\nfinal_c = sum([ray.get(v) for v in values])\n\ncontext.build_result([{\"size\":final_c}])","outputs":[]}]